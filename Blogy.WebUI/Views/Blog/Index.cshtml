@using PagedList.Core
@using PagedList.Core.Mvc
@model IPagedList<ResultBlogDto>

@{
    ViewData["Title"] = "Bloglar";
    Layout = "~/Views/UILayout/Index.cshtml";

    var customOptions = PagedListRenderOptions.Bootstrap4PageNumbersPlusPrevAndNext;
    customOptions.LinkToPreviousPageFormat = "Önceki";
    customOptions.LinkToNextPageFormat = "Sonraki";
}

<!-- BAŞLIK -->
<div class="py-4 bg-light border-bottom text-center mb-4">
    <h2 class="fw-bold mb-1">Bloglar</h2>
    <p class="text-muted">En son yayınlanan yazıları keşfedin.</p>
</div>

<!-- BLOG LIST -->
<div class="container mb-5">
    <div class="row gx-4">
        <!-- SAĞ-SOL MESAFE EKLENDİ -->
        <!-- BLOG CONTENT -->
        <div class="col-lg-8">

            @if (!Model.Any())
            {
                <div class="alert alert-info">Henüz blog bulunamadı.</div>
            }
            else
            {
                @foreach (var item in Model)
                {
                    <div class="card mb-4 shadow-sm border-0">

                        <div class="row g-0">

                            <!-- GÖRSEL -->
                            <div class="col-md-4">
                                <a href="/Blog/Detail/@item.Id">
                                    <img src="@item.CoverImage" class="img-fluid rounded-start w-100"
                                         style="height:165px; object-fit:cover;">
                                </a>
                            </div>

                            <!-- METİN -->
                            <div class="col-md-8">
                                <div class="card-body">

                                    <small class="text-muted d-block mb-1">
                                        @item.CreatedDate.ToString("dd MMM yyyy") ·
                                        <a href="/Blog/GetBlogsByCategory/@item.CategoryId"
                                           class="text-decoration-none text-primary">
                                            @item.Category?.Name
                                        </a>
                                    </small>

                                    <h5 class="card-title mb-2">
                                        <a href="/Blog/Detail/@item.Id" class="text-dark text-decoration-none">
                                            @item.Title
                                        </a>
                                    </h5>

                                    <p class="card-text text-muted mb-2">
                                        @(item.Description.Length > 160
                                                                        ? item.Description.Substring(0, 160) + "..."
                                                                        : item.Description)
                            </p>

                                    <a href="/Blog/Detail/@item.Id" class="btn btn-sm btn-outline-primary">
                                        Devamını Oku
                                    </a>

                                </div>
                            </div>

                        </div>
                    </div>
                        }
            }

            <!-- PAGINATION -->
            <div class="pt-3 border-top">
                <pager asp-controller="Blog" asp-action="Index" list="@Model" options="@customOptions"></pager>
            </div>

        </div>

        <!-- SIDEBAR -->
        <div class="col-lg-4">

            @await Component.InvokeAsync("BlogsByCategoryLatestBlogs")

            <div class="mt-4">
                @await Component.InvokeAsync("CategoryListSidebar")
            </div>

        </div>

    </div>
</div>
